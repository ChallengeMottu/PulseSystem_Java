<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Cadastro de Motos</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/register.css}" />
    <meta charset="UTF-8">
</head>
<body>
<div class="form-container">
    <h2>Cadastro de Motos</h2>

    <!-- Mensagens gerais -->
    <div th:if="${success}" class="success-message">
        <p th:text="${success}"></p>
    </div>

    <div th:if="${errorMessage}" class="error-message">
        <p th:text="${errorMessage}"></p>
    </div>

    <form th:action="@{/motorcycles/register}" th:object="${motorcycle}" method="post" class="horizontal-form">
        <div class="form-row">
            <!-- Linha 1: Placa e Chassi -->
            <div class="form-group">
                <label>Placa:</label>
                <input type="text" th:field="*{licensePlate}" required
                       placeholder="ABC-1D23"
                       class="form-input" />
                <div th:if="${#fields.hasErrors('licensePlate')}" class="field-error">
                    <span th:errors="*{licensePlate}"></span>
                </div>
            </div>

            <div class="form-group">
                <label>Número de chassi:</label>
                <input type="text" th:field="*{chassisNumber}" required
                       placeholder="Digite o número do chassi"
                       class="form-input" />
                <div th:if="${#fields.hasErrors('chassisNumber')}" class="field-error">
                    <span th:errors="*{chassisNumber}"></span>
                </div>
            </div>
        </div>

        <div class="form-row">
            <!-- Linha 2: Condição Mecânica e Modelo -->
            <div class="form-group">
                <label>Condição Mecânica:</label>
                <input type="text" th:field="*{mechanicalCondition}" required
                       placeholder="Ex: Ótima, Boa, Regular"
                       class="form-input" />
                <div th:if="${#fields.hasErrors('mechanicalCondition')}" class="field-error">
                    <span th:errors="*{mechanicalCondition}"></span>
                </div>
            </div>

            <div class="form-group">
                <label>Modelo:</label>
                <select th:field="*{model}" required class="form-input">
                    <option value="">Selecione o modelo</option>
                    <option th:value="SPORT_110i">Sport 110i</option>
                    <option th:value="MOTTU_E">Mottu E</option>
                    <option th:value="SPORT_ESD">Sport ESD</option>
                    <option th:value="POP_110i">Pop 110i</option>
                </select>
                <div th:if="${#fields.hasErrors('model')}" class="field-error">
                    <span th:errors="*{model}"></span>
                </div>
            </div>
        </div>

        <div class="form-row">
            <!-- Linha 3: Status Operacional -->
            <div class="form-group full-width">
                <label>Status Operacional:</label>
                <select th:field="*{operationalStatus}" required class="form-input">
                    <option value="">Selecione o status</option>
                    <option th:value="EM_USO">Operando</option>
                    <option th:value="DISPONIVEL">Disponível</option>
                    <option th:value="EM_MANUTENCAO">Manutenção</option>
                </select>
                <div th:if="${#fields.hasErrors('operationalStatus')}" class="field-error">
                    <span th:errors="*{operationalStatus}"></span>
                </div>
            </div>
        </div>

        <!-- CAMPO HIDDEN para parkingId (igual ao employees) -->
        <input type="hidden" th:field="*{parkingId}" />

        <div class="form-actions">
            <button type="submit" class="btn-primary">Cadastrar Moto</button>
            <a th:href="@{/motorcycles/list}" class="cancel-btn">Cancelar</a>
        </div>
    </form>
</div>

<script>
    // Máscara para placa
    document.addEventListener('DOMContentLoaded', function() {
        const placaInput = document.querySelector('input[th\\:field="*{licensePlate}"]');
        if (placaInput) {
            placaInput.addEventListener('input', function(e) {
                let value = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
                if (value.length > 3) {
                    value = value.substring(0, 3) + '-' + value.substring(3, 7);
                }
                e.target.value = value;
            });
        }

        // Foco no primeiro campo com erro
        const firstError = document.querySelector('.field-error');
        if (firstError) {
            const input = firstError.previousElementSibling;
            if (input && input.classList.contains('form-input')) {
                input.focus();
                input.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
    });
</script>
</body>
</html>